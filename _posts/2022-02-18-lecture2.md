---
layout: post
title:  "Лемма Линдстрёма и матричная теорема Кирхгофа"
ref: lecture2
categories: lecture
---

+ [<mark>Видео</mark>](https://drive.google.com/file/d/1wnTEwa6CbB3dNqWHABsJhRhUeSZ8EM3y/view?usp=sharing)
+ [<mark>Доска</mark>]({{site.baseurl}}/whiteboard/lec2.png)


## ---Тезисы---

Пусть электрическая цень имеет \\(n\\) узлов, между которыми протянуты резисторы. Пусть между узлами \\(i\\) и \\(j\\) находится резистор с проводимостью (обратным сопротивлением) \\(c_{ij} = c_{ji}\\). Итоговое сопротивление цепи между любыми двумя узлами может быть подсчитано в терминах миноров _лапласиана_ \\(L = (\ell_{ij})\_{i,j=1}^n\\), где 
\\[
\ell_{ij} = \begin{cases} \sum\limits_{k\neq i} c_{ik}, &\mbox{если } i=j; \\\ -c_{ij}, &\mbox{если } i \neq j. \end{cases}
\\]

Например, сопротивление между узлами \\(1\\) и \\(n\\) равно
\\[
R_{1n} = \frac{\det L^{(1n)}}{\det L^{(n)}},
\\]  
где \\(L^{(n)}\\) получается из \\(L\\) вычеркиванием строки \\(n\\) и столбца \\(n\\), а \\(L^{(1,n)}\\) получается из \\(L\\) вычеркиванием строк \\(1, n\\) и столбцов \\(1, n\\).

Этой формуле можно придать комбинаторный смысл, если использовать замечательную теорему, неявно содержащуюся в старой работе Кирхгофа. В простом случае, когда все проводимости единичные, получится следующий способ подсчитать \\(R_{1n}\\). Знаменатель \\(\det L^{(n)}\\) равен количеству остовных деревьев в графе электрической цепи. Чтобы найти числитель \\(\det L^{(1n)}\\), нужно добавить к графу ребро \\(\\{1,n\\}\\), если его не было, и после этого подсчитать количество остовных деревьев, содержащих это ребро. В случае произвольных проводимостей нужно считать не количества деревьев, а суммы их весов, определяемых как произведения проводимостей рёбер.

> **Матричная теорема о деревьях [Kirchhoff, 1847].**
По неориентированному графу \\(G = (V, E)\\) на \\(n\\) вершинах строится лапласиан \\(L = (\ell_{ij})\_{i,j=1}^n\\), где \\(\ell_{ii}\\) есть степень вершины \\(i\\), \\(\ell_{ij} = -1\\), если вершины \\(i,j\\) соединены ребром, и \\(\ell_{ij} = 0\\) иначе. Тогда любой главный минор матрицы \\(L\\) размера \\(n-1\\) (например, \\(\det L^{(n)}\\)) равен числу остовных деревьев в графе \\(G\\).

Аналогично можно сформулировать и доказать версию этой теоремы для взвешенного графа. Доказательство с лекции основывалось на следующих леммах.

> **Лемма [Lindström, 1973; Gessel--Viennot, 1985].**
Пусть \\(G = (V,E)\\) --- ориентированный граф без (ориентированных) циклов и с весовой функцией \\(w:E\to \mathbb{R}\\). Пусть в нём выделены непересекающиеся подмножества вершин \\(A = \\{A_1, \ldots, A_n\\}, B = \\{B_1, \ldots, B_n\\}\\) одинаковой мощности \\(n\\). Весом ориентированного пути назовём произведение весов его рёбер: \\(w(P) = \prod\limits_{e \in P} w(e)\\). Положим \\(m_{ij}\\) равным сумме весов всех путей из \\(A_i\\) в \\(B_j\\) и образуем матрицу \\(M = (m_{ij})\_{i,j=1}^n\\). Будем рассматривать системы путей \\((P_1, \ldots, P_n)\\), соединяющие \\(A\\) с \\(B\\); то есть \\(P_i\\) идёт из \\(A_i\\) в \\(B_{\sigma(i)}\\) для некоторой перестановки \\(\sigma\\). Тогда для вершинно непересекающихся систем путей выполнено равенство 
\\[
\det M = \sum_{\substack{\text{верш. неперес. сист.} \\\ (P_1, \ldots, P_n)\\\P_i \text{ из } A_i \text{ в } B_{\sigma(i)}\\\ \sigma \in S_n}} \mbox{sign } \sigma \cdot w(P_1) \cdot \ldots  \cdot w(P_n).
\\]

Если раскрыть детерминант слева по формуле полного разложения, то получится то же, что и справа, но без дополнительного ограничения на непересечение. Содержание леммы в том, что вклад от пересекающихся систем уничтожается.

> **Формула Бине--Коши.**
Пусть \\(P\\) --- матрица \\(n \times m\\), \\(Q\\)&nbsp;--- матрица \\(m \times n\\), причём \\(m \ge n\\). Для системы индексов \\(I \subset \\{1,\ldots, m\\}\\) обозначим через \\(P_I\\) подматрицу матрицы \\(P\\), образованную столбцами с номерами из \\(I\\); аналогично введём \\(Q_I\\) как матрицу со строками из \\(Q\\) с номерами из \\(I\\). Тогда
\\[
\det PQ = \sum_{|I| = n} \det P_I \det Q_I.
\\]

## ---Cсылки---
+ В. Приезжев, [Задача о димерах и теорема Кирхгофа](https://fktpm.ru/file/207-priezzev-zadaca-o-dimerax-i-teorema-kirxgofa.pdf). _Успехи физических наук_ (1985).
+ M. Aigner, G. Ziegler, [Proofs from THE BOOK](https://proofsfromthebook.github.io).
+ L. Lovász, [Graphs and geometry](http://web.cs.elte.hu/~lovasz/bookxx/geombook2019-01-20.pdf). _American Mathematical Society_ (2019).